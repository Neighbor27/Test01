<!DOCTYPE html>
<html>
  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="preconnect" href="https://fonts.gstatic.com/" crossorigin="" />
    
    <link rel="preload" as="style" href="https://fonts.googleapis.com/css2?display=swap&family=Noto+Sans%3Awght@400;500;700;900&family=Work+Sans%3Awght@400;500;700;900" />

    <link
      rel="stylesheet"
      as="style"
      onload="this.rel='stylesheet'"
      href="https://fonts.googleapis.com/css2?display=swap&family=Noto+Sans%3Awght@400;500;700;900&family=Work+Sans%3Awght@400;500;700;900"
    />
    <title>Stitch Design</title>
    <link rel="icon" type="image/x-icon" href="data:image/x-icon;base64," />
    <script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
    <style>
      .hidden { display: none; }
      .card {
        border: 1px solid #dce0e5;
        transition: transform 0.2s ease-out, border-color 0.2s ease-out, box-shadow 0.2s ease-out;
        cursor: pointer;
        position: relative; 
        background-color: #fff;
        z-index: 1;
      }
      .card.selected {
        animation: subtle-light-pulse 3s infinite alternate ease-in-out;
      }

      /* 데스크탑 호버 효과 */
      @media (hover: hover) and (pointer: fine) {
        .card:not(.selected):hover {
          transform: translateY(-4px);
          border-color: #a0a8b1;
          box-shadow: 0 3px 12px rgba(0,0,0,0.1);
        }
        .card.selected:hover {
          transform: translateY(-4px);
        }
      }

      /* 터치 기기에서 선택 시 올라간 상태 유지 */
      @media (hover: none) and (pointer: coarse) {
        .card.selected {
          transform: translateY(-4px) !important;
        }
      }
      
      @keyframes subtle-light-pulse {
        from {
          box-shadow: 0 0 8px 1px #1466b8;
        }
        to {
          box-shadow: 0 0 4px 2px #1574c1;
        }
      }

      #next-button {
        transition: transform 0.2s ease-out, background-color 0.2s ease-out;
      }
      #next-button:hover {
        transform: translateY(-3px);
        background-color: #1a73c8; 
      }
      @media (min-width: 768px) {
        .layout-container {
          min-width: 720px;
        }
      }
    </style>
  </head>
  <body>
    <div
      class="relative flex size-full min-h-screen flex-col bg-white group/design-root overflow-x-auto md:overflow-x-hidden"
      style='font-family: "Work Sans", "Noto Sans", sans-serif;'
    >
      <div class="layout-container flex h-full grow flex-col">
        <div id="header-placeholder"></div>
        <div class="flex flex-1 flex-col py-8 px-4 md:px-40 md:py-16">
          <div class="layout-content-container flex flex-col w-full max-w-[700px] self-center">
            <!-- 상대방 정보 섹션 -->
            <div>
              <div class="px-4 md:px-0 pb-5">
                <h2 class="text-[28px] sm:text-[32px] md:text-[43px] font-bold leading-tight whitespace-nowrap overflow-hidden text-ellipsis">
                  <span id="target-name">상대방</span>의 정보를 선택하세요
                </h2>
              </div>
              <!-- 상대방 성별 -->
              <div class="pt-2">
                <div class="px-4 md:px-0 pb-2">
                    <h3 class="text-lg sm:text-xl font-bold leading-tight tracking-[-0.015em] text-[#111418]">성별</h3>
                </div>
                <div class="flex flex-wrap gap-4 p-4 md:p-0">
                  <label class="card relative flex h-12 cursor-pointer items-center justify-center rounded-lg px-6 text-base font-medium leading-normal text-[#111418] md:h-14 md:text-lg">
                    남성
                    <input type="radio" class="absolute invisible" name="target_gender" />
                  </label>
                  <label class="card relative flex h-12 cursor-pointer items-center justify-center rounded-lg px-6 text-base font-medium leading-normal text-[#111418] md:h-14 md:text-lg">
                    여성
                    <input type="radio" class="absolute invisible" name="target_gender" />
                  </label>
                  <label class="card relative flex h-12 cursor-pointer items-center justify-center rounded-lg px-6 text-base font-medium leading-normal text-[#111418] md:h-14 md:text-lg">
                    그 외
                    <input type="radio" class="absolute invisible" name="target_gender" />
                  </label>
                </div>
              </div>
              <!-- 상대방 나이 -->
              <div class="pt-6">
                <div class="px-4 md:px-0 pb-2">
                    <h3 class="text-lg sm:text-xl font-bold leading-tight tracking-[-0.015em] text-[#111418]">나이</h3>
                </div>
                <div class="flex flex-wrap justify-start gap-4 p-4 md:p-0">
                  <label class="card relative flex h-12 cursor-pointer items-center justify-center rounded-lg px-6 text-base font-medium leading-normal text-[#111418] md:h-14 md:text-lg">
                    10대 <input type="radio" class="absolute invisible" name="target_age" />
                  </label>
                  <label class="card relative flex h-12 cursor-pointer items-center justify-center rounded-lg px-6 text-base font-medium leading-normal text-[#111418] md:h-14 md:text-lg">
                    20대 <input type="radio" class="absolute invisible" name="target_age" />
                  </label>
                  <label class="card relative flex h-12 cursor-pointer items-center justify-center rounded-lg px-6 text-base font-medium leading-normal text-[#111418] md:h-14 md:text-lg">
                    30대 <input type="radio" class="absolute invisible" name="target_age" />
                  </label>
                  <label class="card relative flex h-12 cursor-pointer items-center justify-center rounded-lg px-6 text-base font-medium leading-normal text-[#111418] md:h-14 md:text-lg">
                    40대 <input type="radio" class="absolute invisible" name="target_age" />
                  </label>
                  <label class="card relative flex h-12 cursor-pointer items-center justify-center rounded-lg px-6 text-base font-medium leading-normal text-[#111418] md:h-14 md:text-lg">
                    50대 <input type="radio" class="absolute invisible" name="target_age" />
                  </label>
                  <label class="card relative flex h-12 cursor-pointer items-center justify-center rounded-lg px-6 text-base font-medium leading-normal text-[#111418] md:h-14 md:text-lg">
                    60+ <input type="radio" class="absolute invisible" name="target_age" />
                  </label>
                </div>
              </div>
            </div>

            <hr class="my-8 border-t border-[#dce0e5]" />

            <!-- 나의 정보 섹션 -->
            <div class="pt-2">
              <div class="px-4 md:px-0 pb-5">
                <h2 class="text-[28px] sm:text-[32px] md:text-[43px] font-bold leading-tight whitespace-nowrap overflow-hidden text-ellipsis">
                  나의 정보를 선택하세요
                </h2>
              </div>
              <!-- 나의 성별 -->
              <div class="pt-2">
                <div class="px-4 md:px-0 pb-2">
                    <h3 class="text-lg sm:text-xl font-bold leading-tight tracking-[-0.015em] text-[#111418]">성별</h3>
                </div>
                <div class="flex flex-wrap gap-4 p-4 md:p-0">
                  <label class="card relative flex h-12 cursor-pointer items-center justify-center rounded-lg px-6 text-base font-medium leading-normal text-[#111418] md:h-14 md:text-lg">
                    남성 <input type="radio" class="absolute invisible" name="my_gender" />
                  </label>
                  <label class="card relative flex h-12 cursor-pointer items-center justify-center rounded-lg px-6 text-base font-medium leading-normal text-[#111418] md:h-14 md:text-lg">
                    여성 <input type="radio" class="absolute invisible" name="my_gender" />
                  </label>
                  <label class="card relative flex h-12 cursor-pointer items-center justify-center rounded-lg px-6 text-base font-medium leading-normal text-[#111418] md:h-14 md:text-lg">
                    그 외 <input type="radio" class="absolute invisible" name="my_gender" />
                  </label>
                </div>
              </div>
              <!-- 나의 나이 -->
              <div class="pt-6">
                <div class="px-4 md:px-0 pb-2">
                    <h3 class="text-lg sm:text-xl font-bold leading-tight tracking-[-0.015em] text-[#111418]">나이</h3>
                </div>
                <div class="flex flex-wrap justify-start gap-4 p-4 md:p-0">
                  <label class="card relative flex h-12 cursor-pointer items-center justify-center rounded-lg px-6 text-base font-medium leading-normal text-[#111418] md:h-14 md:text-lg">
                    10대 <input type="radio" class="absolute invisible" name="my_age" />
                  </label>
                  <label class="card relative flex h-12 cursor-pointer items-center justify-center rounded-lg px-6 text-base font-medium leading-normal text-[#111418] md:h-14 md:text-lg">
                    20대 <input type="radio" class="absolute invisible" name="my_age" />
                  </label>
                  <label class="card relative flex h-12 cursor-pointer items-center justify-center rounded-lg px-6 text-base font-medium leading-normal text-[#111418] md:h-14 md:text-lg">
                    30대 <input type="radio" class="absolute invisible" name="my_age" />
                  </label>
                  <label class="card relative flex h-12 cursor-pointer items-center justify-center rounded-lg px-6 text-base font-medium leading-normal text-[#111418] md:h-14 md:text-lg">
                    40대 <input type="radio" class="absolute invisible" name="my_age" />
                  </label>
                  <label class="card relative flex h-12 cursor-pointer items-center justify-center rounded-lg px-6 text-base font-medium leading-normal text-[#111418] md:h-14 md:text-lg">
                    50대 <input type="radio" class="absolute invisible" name="my_age" />
                  </label>
                  <label class="card relative flex h-12 cursor-pointer items-center justify-center rounded-lg px-6 text-base font-medium leading-normal text-[#111418] md:h-14 md:text-lg">
                    60+ <input type="radio" class="absolute invisible" name="my_age" />
                  </label>
                </div>
              </div>
            </div>
            <div class="flex px-4 md:px-0 py-4 justify-end">
              <div id="next-button-placeholder"></div>
            </div>
          </div>
        </div>
       <div id="footer-placeholder"></div>
    </div>
    
    <script>
      // *** 수정된 부분: 줄바꿈을 방지하고 모든 카드의 너비를 통일하는 새로운 함수 ***
      function unifyCardWidths() {
        const allCards = document.querySelectorAll('.card');
        let maxWidth = 0;

        // 모든 카드의 '진짜' 너비를 측정 (줄바꿈 방지)
        allCards.forEach(card => {
          card.style.width = 'auto'; // 이전에 설정된 너비 초기화
          card.style.whiteSpace = 'nowrap'; // 줄바꿈을 강제로 막음
          
          if (card.offsetWidth > maxWidth) {
            maxWidth = card.offsetWidth;
          }
          
          card.style.whiteSpace = ''; // 원래 상태로 복원
        });

        // 찾은 최대 너비를 모든 카드에 적용
        if (maxWidth > 0) {
          allCards.forEach(card => {
            card.style.width = `${maxWidth}px`;
          });
        }
      }

      document.addEventListener('componentsLoaded', () => {
        const nextButton = document.getElementById('next-button');
        const radioCards = document.querySelectorAll('.card');

        radioCards.forEach(card => {
            card.addEventListener('click', () => {
                const input = card.querySelector('input');
                const name = input.name;
                const allInputsInGroup = document.querySelectorAll(`input[name="${name}"]`);
                
                allInputsInGroup.forEach(radioInput => {
                    radioInput.parentElement.classList.remove('selected');
                    radioInput.checked = false;
                });
                
                card.classList.add('selected');
                input.checked = true;
            });
        });

        if (nextButton) {
          nextButton.addEventListener('click', () => {
            const targetGender = document.querySelector('input[name="target_gender"]:checked');
            const targetAge = document.querySelector('input[name="target_age"]:checked');
            const myGender = document.querySelector('input[name="my_gender"]:checked');
            const myAge = document.querySelector('input[name="my_age"]:checked');

            if (targetGender && targetAge && myGender && myAge) {
              window.location.href = 'page4.html';
            } else {
              alert('모든 정보를 선택해주세요.');
            }
          });
        }

        const savedTarget = localStorage.getItem('selectedTarget');
        if (savedTarget) {
          document.getElementById('target-name').textContent = savedTarget;
        }

        const checkedRadios = document.querySelectorAll('input[type="radio"]:checked');
        checkedRadios.forEach(radio => {
            radio.parentElement.classList.add('selected');
        });

        // 페이지 로드 및 화면 크기 변경 시 카드 너비 통일 함수 호출
        unifyCardWidths();
        window.addEventListener('resize', unifyCardWidths);
      });
    </script>
    <script src="loadComponents.js"></script>
  </body>
</html>