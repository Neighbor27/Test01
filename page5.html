<!DOCTYPE html>
<html>
  <head>
    <link rel="preconnect" href="https://fonts.gstatic.com/" crossorigin="" />
    <link
      rel="stylesheet"
      as="style"
      onload="this.rel='stylesheet'"
      href="https://fonts.googleapis.com/css2?display=swap&family=Noto+Sans%3Awght@400;500;700;900&family=Work+Sans%3awght@400;500;700;900"
    />

    <title>Stitch Design</title>
    <link rel="icon" type="image/x-icon" href="data:image/x-icon;base64," />

    <script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
    <style>
      .hidden {
        display: none;
      }
      /* 선택지 카드 스타일 */
      .card {
        border: 1px solid #dce0e5;
        transition: box-shadow 0.14s ease-in-out;
        cursor: pointer;
        box-shadow: 0 0 0 0 transparent;
      }
      /* 선택된 카드에만 3px 파란색 그림자를 적용 */
      .card.selected {
        box-shadow: 0 0 0 3px #1466b8;
      }
      .mbti-tab {
        text-align: center;
        flex: 1;
        cursor: pointer;
        padding-left: 0.5rem;
        padding-right: 0.5rem;
        flex-basis: 50%;
        max-width: 50%;
      }
      /* '아직 모름' 탭은 너비를 100%로 유지 */
      .mbti-tab.w-full {
        flex-basis: 100%;
        max-width: 100%;
      }
      .mbti-tab-group .mbti-tab.active {
        border-bottom-color: #111418;
        color: #111418;
      }
      .mbti-tab-group .mbti-tab:not(.active) {
        border-bottom-color: transparent;
        color: #637588;
      }
    </style>
  </head>
  <body>
    <div
      class="relative flex size-full min-h-screen flex-col bg-white group/design-root overflow-x-auto"
      style='font-family: "Work Sans", "Noto Sans", sans-serif;'
    >
      <div class="layout-container flex h-full grow flex-col">
        <header
          class="flex items-center justify-between whitespace-nowrap border-b border-solid border-b-[#f0f2f4] px-10 py-3"
        >
          <a class="flex items-center gap-4 text-[#111418] cursor-pointer" href="index.html">
            <div class="size-4">
              <svg viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path
                  d="M4 4H17.3334V17.3334H30.6666V30.6666H44V44H4V4Z"
                  fill="currentColor"
                ></path>
              </svg>
            </div>
            <h2 class="text-[#111418] text-lg font-bold leading-tight tracking-[-0.015em]">
              Grace & Connect
            </h2>
          </a>
          <div class="flex flex-1 justify-end gap-8">
            <button
              class="flex max-w-[480px] cursor-pointer items-center justify-center overflow-hidden rounded-lg h-10 bg-[#f0f2f4] text-[#111418] gap-2 text-sm font-bold leading-normal tracking-[0.015em] min-w-0 px-2.5"
            >
              <div class="text-[#111418]" data-icon="Question" data-size="20px" data-weight="regular">
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  width="20px"
                  height="20px"
                  fill="currentColor"
                  viewBox="0 0 256 256"
                >
                  <path
                    d="M140,180a12,12,0,1,1-12-12A12,12,0,0,1,140,180ZM128,72c-22.06,0-40,16.15-40,36v4a8,8,0,0,0,16,0v-4c0-11,10.77-20,24-20s24,9,24,20-10.77,20-24,20a8,8,0,0,0-8,8v8a8,8,0,0,0,16,0v-.72c18.24-3.35,32-17.9,32-35.28C168,88.15,150.06,72,128,72Zm104,56A104,104,0,1,1,128,24,104.11,104.11,0,0,1,232,128Zm-16,0a88,88,0,1,0-88,88A88.1,88.1,0,0,0,216,128Z"
                  ></path>
                </svg>
              </div>
            </button>
            <a href="login.html">
              <button
                class="flex max-w-[480px] cursor-pointer items-center justify-center overflow-hidden rounded-lg h-10 px-4 bg-[#1466b8] text-white text-sm font-bold leading-normal tracking-[0.015em]"
              >
                <span class="truncate">Login</span>
              </button>
            </a>
          </div>
        </header>
        <div class="px-40 flex flex-1 justify-center py-5">
          <div class="layout-content-container flex flex-col w-[512px] max-w-[512px] py-5 mx-auto">
            <h2 class="text-[#111418] tracking-light text-[28px] font-bold leading-tight px-4 text-center pb-3 pt-5">MBTI</h2>
            <h3 class="text-[#111418] text-lg font-bold leading-tight tracking-[-0.015em] px-4 pb-2 pt-4">
              <span id="target-name">Your mate</span>의 MBTI
            </h3>
            <div class="pb-3 mbti-tab-group" data-mbti-group="target_1">
              <div class="flex border-b border-[#dce0e5] px-4 gap-8 justify-center">
                <a class="flex flex-col items-center justify-center border-b-[3px] pb-[13px] pt-4 mbti-tab" href="#" data-mbti-value="E">
                  <p class="text-sm font-bold leading-normal tracking-[0.015em]">E</p>
                </a>
                <a class="flex flex-col items-center justify-center border-b-[3px] pb-[13px] pt-4 mbti-tab" href="#" data-mbti-value="I">
                  <p class="text-sm font-bold leading-normal tracking-[0.015em]">I</p>
                </a>
              </div>
            </div>
            <div class="pb-3 mbti-tab-group" data-mbti-group="target_2">
              <div class="flex border-b border-[#dce0e5] px-4 gap-8 justify-center">
                <a class="flex flex-col items-center justify-center border-b-[3px] pb-[13px] pt-4 mbti-tab" href="#" data-mbti-value="S">
                  <p class="text-sm font-bold leading-normal tracking-[0.015em]">S</p>
                </a>
                <a class="flex flex-col items-center justify-center border-b-[3px] pb-[13px] pt-4 mbti-tab" href="#" data-mbti-value="N">
                  <p class="text-sm font-bold leading-normal tracking-[0.015em]">N</p>
                </a>
              </div>
            </div>
            <div class="pb-3 mbti-tab-group" data-mbti-group="target_3">
              <div class="flex border-b border-[#dce0e5] px-4 gap-8 justify-center">
                <a class="flex flex-col items-center justify-center border-b-[3px] pb-[13px] pt-4 mbti-tab" href="#" data-mbti-value="T">
                  <p class="text-sm font-bold leading-normal tracking-[0.015em]">T</p>
                </a>
                <a class="flex flex-col items-center justify-center border-b-[3px] pb-[13px] pt-4 mbti-tab" href="#" data-mbti-value="F">
                  <p class="text-sm font-bold leading-normal tracking-[0.015em]">F</p>
                </a>
              </div>
            </div>
            <div class="pb-3 mbti-tab-group" data-mbti-group="target_4">
              <div class="flex border-b border-[#dce0e5] px-4 gap-8 justify-center">
                <a class="flex flex-col items-center justify-center border-b-[3px] pb-[13px] pt-4 mbti-tab" href="#" data-mbti-value="J">
                  <p class="text-sm font-bold leading-normal tracking-[0.015em]">J</p>
                </a>
                <a class="flex flex-col items-center justify-center border-b-[3px] pb-[13px] pt-4 mbti-tab" href="#" data-mbti-value="P">
                  <p class="text-sm font-bold leading-normal tracking-[0.015em]">P</p>
                </a>
              </div>
            </div>
            <div class="pb-3 mbti-tab-group" data-mbti-group="target_unknown">
              <div class="flex border-b border-[#dce0e5] px-4 gap-8">
                <a class="flex flex-col items-center justify-center border-b-[3px] pb-[13px] pt-4 mbti-tab w-full" href="#" data-mbti-value="unknown">
                  <p class="text-sm font-bold leading-normal tracking-[0.015em]">아직 모름</p>
                </a>
              </div>
            </div>
            <h3 class="text-[#111418] text-lg font-bold leading-tight tracking-[-0.015em] px-4 pb-2 pt-4">나의 MBTI</h3>
            <div class="pb-3 mbti-tab-group" data-mbti-group="my_1">
              <div class="flex border-b border-[#dce0e5] px-4 gap-8 justify-center">
                <a class="flex flex-col items-center justify-center border-b-[3px] pb-[13px] pt-4 mbti-tab" href="#" data-mbti-value="E">
                  <p class="text-sm font-bold leading-normal tracking-[0.015em]">E</p>
                </a>
                <a class="flex flex-col items-center justify-center border-b-[3px] pb-[13px] pt-4 mbti-tab" href="#" data-mbti-value="I">
                  <p class="text-sm font-bold leading-normal tracking-[0.015em]">I</p>
                </a>
              </div>
            </div>
            <div class="pb-3 mbti-tab-group" data-mbti-group="my_2">
              <div class="flex border-b border-[#dce0e5] px-4 gap-8 justify-center">
                <a class="flex flex-col items-center justify-center border-b-[3px] pb-[13px] pt-4 mbti-tab" href="#" data-mbti-value="S">
                  <p class="text-sm font-bold leading-normal tracking-[0.015em]">S</p>
                </a>
                <a class="flex flex-col items-center justify-center border-b-[3px] pb-[13px] pt-4 mbti-tab" href="#" data-mbti-value="N">
                  <p class="text-sm font-bold leading-normal tracking-[0.015em]">N</p>
                </a>
              </div>
            </div>
            <div class="pb-3 mbti-tab-group" data-mbti-group="my_3">
              <div class="flex border-b border-[#dce0e5] px-4 gap-8 justify-center">
                <a class="flex flex-col items-center justify-center border-b-[3px] pb-[13px] pt-4 mbti-tab" href="#" data-mbti-value="T">
                  <p class="text-sm font-bold leading-normal tracking-[0.015em]">T</p>
                </a>
                <a class="flex flex-col items-center justify-center border-b-[3px] pb-[13px] pt-4 mbti-tab" href="#" data-mbti-value="F">
                  <p class="text-sm font-bold leading-normal tracking-[0.015em]">F</p>
                </a>
              </div>
            </div>
            <div class="pb-3 mbti-tab-group" data-mbti-group="my_4">
              <div class="flex border-b border-[#dce0e5] px-4 gap-8 justify-center">
                <a class="flex flex-col items-center justify-center border-b-[3px] pb-[13px] pt-4 mbti-tab" href="#" data-mbti-value="J">
                  <p class="text-sm font-bold leading-normal tracking-[0.015em]">J</p>
                </a>
                <a class="flex flex-col items-center justify-center border-b-[3px] pb-[13px] pt-4 mbti-tab" href="#" data-mbti-value="P">
                  <p class="text-sm font-bold leading-normal tracking-[0.015em]">P</p>
                </a>
              </div>
            </div>
            <div class="pb-3 mbti-tab-group" data-mbti-group="my_unknown">
              <div class="flex border-b border-[#dce0e5] px-4 gap-8">
                <a class="flex flex-col items-center justify-center border-b-[3px] pb-[13px] pt-4 mbti-tab w-full" href="#" data-mbti-value="unknown">
                  <p class="text-sm font-bold leading-normal tracking-[0.015em]">아직 모름</p>
                </a>
              </div>
            </div>
            <div class="flex px-4 py-3 justify-between">
              <button
                id="learn-mbti-button"
                class="flex min-w-[84px] max-w-[480px] cursor-pointer items-center justify-center overflow-hidden rounded-lg h-10 px-4 bg-[#f0f2f4] text-[#111418] text-sm font-bold leading-normal tracking-[0.015em]"
              >
                <span class="truncate">내 MBTI 알아보기</span>
              </button>
              <button
                id="next-button"
                class="flex min-w-[84px] max-w-[480px] cursor-pointer items-center justify-center overflow-hidden rounded-lg h-10 px-4 bg-[#1466b8] text-white text-sm font-bold leading-normal tracking-[0.015em]"
              >
                <span class="truncate">다음</span>
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>
   <script>
    document.addEventListener('DOMContentLoaded', () => {
        const nextButton = document.getElementById('next-button');
        const learnMbtiButton = document.getElementById('learn-mbti-button');
        const mbtiTabGroups = document.querySelectorAll('.mbti-tab-group');
        const targetNameElement = document.getElementById('target-name');

        const getParamsFromUrl = () => {
            const params = new URLSearchParams(window.location.search);
            return {
                name: params.get('name'),
                myMbti: params.get('mbti') // mbti_test.html에서 'mbti'로 넘어온 값
            };
        };

        const { name, myMbti } = getParamsFromUrl();

        if (name) {
            targetNameElement.textContent = name;
        }

        // mbti_test.html에서 넘어온 나의 MBTI 값으로 탭을 활성화합니다.
        const activateMyMbtiTabs = (mbtiString) => {
            if (!mbtiString || mbtiString.length !== 4) return;
            const mbtiChars = mbtiString.split('');

            mbtiChars.forEach((char, index) => {
                const groupName = `my_${index + 1}`;
                const group = document.querySelector(`.mbti-tab-group[data-mbti-group="${groupName}"]`);
                if (group) {
                    const tab = group.querySelector(`.mbti-tab[data-mbti-value="${char}"]`);
                    if (tab) {
                        group.querySelectorAll('.mbti-tab').forEach(t => t.classList.remove('active'));
                        tab.classList.add('active');
                    }
                }
            });
        };

        if (myMbti) {
            activateMyMbtiTabs(myMbti);
        }

        mbtiTabGroups.forEach(group => {
            const tabs = group.querySelectorAll('.mbti-tab');
            tabs.forEach(tab => {
                tab.addEventListener('click', (e) => {
                    e.preventDefault();
                    const groupName = group.getAttribute('data-mbti-group');
                    const isUnknownTab = tab.getAttribute('data-mbti-value') === 'unknown';
                    const groupPrefix = groupName.split('_')[0];

                    if (isUnknownTab) {
                        const mainGroups = document.querySelectorAll(`.mbti-tab-group[data-mbti-group^="${groupPrefix}_"]:not([data-mbti-group$="unknown"])`);
                        mainGroups.forEach(mainGroup => {
                            mainGroup.querySelectorAll('.mbti-tab').forEach(mainTab => {
                                mainTab.classList.remove('active');
                            });
                        });
                        group.querySelector('.mbti-tab[data-mbti-value="unknown"]').classList.add('active');
                    } else {
                        const parentDiv = tab.closest('.mbti-tab-group');
                        if (parentDiv) {
                            const siblingTabs = parentDiv.querySelectorAll('.mbti-tab');
                            siblingTabs.forEach(siblingTab => {
                                siblingTab.classList.remove('active');
                            });
                        }
                        const unknownGroup = document.querySelector(`.mbti-tab-group[data-mbti-group="${groupPrefix}_unknown"]`);
                        if (unknownGroup) {
                            const unknownTab = unknownGroup.querySelector('.mbti-tab[data-mbti-value="unknown"]');
                            if (unknownTab && unknownTab.classList.contains('active')) {
                                unknownTab.classList.remove('active');
                            }
                        }
                        tab.classList.add('active');
                    }
                });
            });
        });

        if (nextButton) {
            nextButton.addEventListener('click', () => {
                const mySelections = {};
                const targetSelections = {};

                document.querySelectorAll('.mbti-tab-group[data-mbti-group^="my_"]').forEach(group => {
                    const activeTab = group.querySelector('.mbti-tab.active');
                    if (activeTab) {
                        mySelections[group.getAttribute('data-mbti-group')] = activeTab.getAttribute('data-mbti-value');
                    }
                });
                document.querySelectorAll('.mbti-tab-group[data-mbti-group^="target_"]').forEach(group => {
                    const activeTab = group.querySelector('.mbti-tab.active');
                    if (activeTab) {
                        targetSelections[group.getAttribute('data-mbti-group')] = activeTab.getAttribute('data-mbti-value');
                    }
                });

                // 선택 여부 확인 로직
                const checkMbtiSelection = (mbtiSelections, isMy) => {
                    const prefix = isMy ? 'my_' : 'target_';
                    const isUnknownSelected = mbtiSelections[`${prefix}unknown`] === 'unknown';
                    const allFourSelected = mbtiSelections[`${prefix}1`] && mbtiSelections[`${prefix}2`] && mbtiSelections[`${prefix}3`] && mbtiSelections[`${prefix}4`];
                    return isUnknownSelected || allFourSelected;
                };

                const isMyMbtiSelected = checkMbtiSelection(mySelections, true);
                const isTargetMbtiSelected = checkMbtiSelection(targetSelections, false);

                if (isMyMbtiSelected && isTargetMbtiSelected) {
                    const myMbtiResult = mySelections['my_unknown'] === 'unknown' ? 'unknown' : (mySelections['my_1'] + mySelections['my_2'] + mySelections['my_3'] + mySelections['my_4']);
                    const targetMbtiResult = targetSelections['target_unknown'] === 'unknown' ? 'unknown' : (targetSelections['target_1'] + targetSelections['target_2'] + targetSelections['target_3'] + targetSelections['target_4']);
                    
                    const url = `page6.html?name=${encodeURIComponent(name)}&my_mbti=${myMbtiResult}&target_mbti=${targetMbtiResult}`;
                    
                    window.location.href = url;
                } else {
                    alert('모든 MBTI 정보를 선택하거나 "아직 모름"을 체크해주세요.');
                }
            });
        }
        
        if (learnMbtiButton) {
            learnMbtiButton.addEventListener('click', () => {
                const url = `mbti_test.html?name=${encodeURIComponent(name)}`;
                window.location.href = url;
            });
        }
    });
</script>
  </body>
</html>